{% extends "layout.twig" %}

{% block title %}${ "Manage Groups" | translate }{% endblock %}

{% block content %}
            <form class="detail" action="index.php" method="get" accept-charset="utf-8">
                <fieldset>
                    <input type="hidden" name="action" value="manage_groups">
                    <div role="search" class="detail_single">
                        <h3>${ "Search all groups for user&hellip;" | translate }</h3>
                        <input class="text" type="text" name="search" value="${ GET.search | escape }" id="search">
                        <button type="submit">${ "Search" | translate }</button>
                        {% if visitor.group.can("add_group") %}
                        <a href="{% admin "new_group" %}" class="button yay">
                            <img src="$theme_url/images/icons/add.svg" alt="add"> ${ "New Group" | translate }
                        </a>
                        {% endif %}
                    </div>
                </fieldset>
            </form>
            <h2>${ "Groups" | translate }</h2>
            <table border="0" cellspacing="0" cellpadding="0" class="wide">
                <thead>
                    <tr class="head">
                        <th class="group_name">${ "Group" | translate }</th>
                        <th class="group_size">${ "Members" | translate }</th>
                        <th class="group_default">${ "Default?" | translate }</th>
                        <th class="group_guest">${ "Guests?" | translate }</th>
                        ${ trigger.call("manage_groups_column_header") }
                        <th class="controls" colspan="2">${ "Controls" | translate }</th>
                    </tr>
                </thead>
                <tbody>
                {% for group in groups.paginated %}
                    <tr id="user_$user.id" class="user">
                        <td class="group_name main">
                            ${ group.name | escape }
                        </td>
                        <td class="group_size">
                            <a href="${ route.url('/admin/?action=manage_users&query=group%3A'~group.name) }">${ group.size | escape }</a>
                        </td>
                        <td class="group_default">
                        {% if group.id == site.default_group %}
                            <img class="emblem" src="$theme_url/images/icons/success.svg" alt="yes">
                        {% endif %}
                        </td>
                        <td class="group_guest">
                        {% if group.id == site.guest_group %}
                            <img class="emblem" src="$theme_url/images/icons/success.svg" alt="yes">
                        {% endif %}
                        </td>
                        ${ trigger.call("manage_groups_column", user) }
                        <td class="controls">${ group.edit_link('<img src="'~ theme_url ~'/images/icons/edit.svg" alt="'~ ("edit" | translate) ~'">') }</td>
                        <td class="controls">${ group.delete_link('<img src="'~ theme_url ~'/images/icons/delete.svg" alt="'~ ("delete" | translate) ~'">') }</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
            {% if groups.paginated and groups.pages > 1 %}
            <div class="pagination">
                $groups.prev_link
                <span class="pages">${ "Page %d of %d" | translate | format(groups.page, groups.pages) }</span>
                $groups.next_link
            </div>
            {% endif %}
{% endblock %}
